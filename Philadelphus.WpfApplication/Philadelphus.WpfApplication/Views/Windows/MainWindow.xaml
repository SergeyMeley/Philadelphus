<Window x:Class="Philadelphus.WpfApplication.Views.Windows.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Philadelphus.WpfApplication.Views.Windows"
        xmlns:viewmodels="clr-namespace:Philadelphus.WpfApplication.ViewModels"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        xmlns:ctrls="clr-namespace:Philadelphus.WpfApplication.Views.Controls"
        xmlns:ntf="clr-namespace:Philadelphus.Business.Services;assembly=Philadelphus.Business"
        d:DataContext="{d:DesignInstance Type=viewmodels:ApplicationVM}"
        mc:Ignorable="d"
        Title="{Binding Title}"
        MinHeight="500" MinWidth="1000"
        WindowState="Maximized">
    <Window.CommandBindings>
        <!--<CommandBinding Command="New" CanExecute="CommonCommandBinding_CanExecute" />
        <CommandBinding Command="Open" CanExecute="CommonCommandBinding_CanExecute" />
        <CommandBinding Command="Save" CanExecute="CommonCommandBinding_CanExecute" />-->
    </Window.CommandBindings>
    <Grid>
        <Grid.Background>
            <SolidColorBrush Color="#FFF1F1F1"/>
        </Grid.Background>
        <Popup DataContext="{Binding PopupVM}" IsOpen="{Binding IsOpen}" Placement="Top" PlacementTarget="{Binding ElementName=popupTarget}" HorizontalAlignment="Right" HorizontalOffset="-5" VerticalOffset="-5" AllowsTransparency="True" PopupAnimation="Scroll">
            <StackPanel>
                <ListBox ItemsSource="{Binding NotificationList}">
                    <ListBox.ItemTemplate>
                        <ItemContainerTemplate>
                            <Border BorderThickness="3" CornerRadius="5" BorderBrush="SlateGray" Background="LightGray">
                                <StackPanel>
                                    <TextBlock Foreground="Black" Height="70" Width="300" Padding="10" Text="{Binding Text}"></TextBlock>
                                </StackPanel>
                            </Border>
                           
                            
                        </ItemContainerTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
        </Popup>
        <DockPanel>
            <Ribbon DockPanel.Dock="Top" Background="Transparent">
                <Ribbon.HelpPaneContent>
                    <RibbonButton  />
                </Ribbon.HelpPaneContent>
                <Ribbon.QuickAccessToolBar>
                    <RibbonQuickAccessToolBar >
                        
                    </RibbonQuickAccessToolBar>
                </Ribbon.QuickAccessToolBar>
                <Ribbon.ApplicationMenu>
                    <RibbonApplicationMenu>
                        <!--<RibbonApplicationMenu.SmallImageSource>
                            <BitmapImage UriSource="C:\Users\MeleychukSV\Downloads\icons8-квадратный-корень-2-64.png" />
                        </RibbonApplicationMenu.SmallImageSource>-->
                        <RibbonApplicationMenu.SmallImageSource>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <GlyphRunDrawing ForegroundBrush="White">
                                        <GlyphRunDrawing.GlyphRun>
                                            <GlyphRun
                                                CaretStops="{x:Null}" 
                                                ClusterMap="{x:Null}" 
                                                IsSideways="False" 
                                                GlyphOffsets="{x:Null}" 
                                                GlyphIndices="41 76 79 72" 
                                                FontRenderingEmSize="12" 
                                                DeviceFontName="{x:Null}" 
                                                AdvanceWidths="5.859375 2.90625 2.90625 6.275390625">
                                                <GlyphRun.GlyphTypeface>
                                                    <GlyphTypeface FontUri="C:\WINDOWS\Fonts\SEGOEUI.TTF"/>
                                                </GlyphRun.GlyphTypeface>
                                            </GlyphRun>
                                        </GlyphRunDrawing.GlyphRun>
                                    </GlyphRunDrawing>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </RibbonApplicationMenu.SmallImageSource>
                        <RibbonApplicationMenuItem Header="Hello _Ribbon" />
                        <RibbonButton Label="Открыть локальный репозиторий"/>
                        <RibbonButton Label="Открыть удаленный репозиторий"/>
                        <RibbonButton Label="Создать пустой репозиторий"/>
                        <RibbonButton Label="Создать из шаблона"/>
                    </RibbonApplicationMenu>
                </Ribbon.ApplicationMenu>
                <RibbonTab Header="Главная">
                    <RibbonGroup Header="Буфер обмена">
                        <RibbonButton Label="Копировать" />
                        <RibbonButton Label="Вырезать" />
                        <RibbonButton Label="Вставить" />
                        <RibbonButton Label="Дублировать" />
                        <RibbonButton Label="Переместить" />
                    </RibbonGroup>
                    <RibbonGroup Header="Общее">
                        <RibbonSplitButton Label="Добавить элемент">
                            <RibbonButton Label="Добавить корень"></RibbonButton>
                            <RibbonButton Label="Добавить узел"></RibbonButton>
                            <RibbonButton Label="Добавить лист"></RibbonButton>
                        </RibbonSplitButton>
                    </RibbonGroup> 
                </RibbonTab>
                <RibbonTab Header="Репозиторий">
                    <RibbonGroup Header="Текущий репозиторий">
                        <!--<RibbonComboBox ItemsSource="{Binding TreeRepositories}" DisplayMemberPath="Name">
                            <RibbonComboBox.Style>
                                <Style TargetType="RibbonComboBox" BasedOn="{StaticResource SyncfusionRibbonComboBoxStyle}">
                                    <Style.Triggers>
                                        <Trigger Property="LayoutTransform"  Value="True">
                                            <Setter Property="Height" Value="25"/>
                                            <Setter Property="Width" Value="100"/>
                                            <Setter Property="Margin" Value="2"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </RibbonComboBox.Style>
                        </RibbonComboBox>-->
                        <ComboBox ItemsSource="{Binding RepositoryCollectionVM.TreeRepositoriesVMs}" DisplayMemberPath="Name" SelectedItem="{Binding RepositoryCollectionVM.CurrentRepositoryExplorerVM}"  IsEditable="True" IsReadOnly="True" Width="auto" MinWidth="200" IsEnabled="False"></ComboBox>
                        
                        <RibbonButton Label="Настроить список репозиториев" DataContext="{Binding RepositoryCollectionVM}" Command="{Binding OpenRepositoryCollectionSettingsWindow}" />
                    </RibbonGroup>
                    <RibbonGroup Header="Информация">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Состояние: "></TextBlock>
                            <TextBlock Text="{Binding RepositoryCollectionVM.CurrentRepositoryExplorerVM.State}"></TextBlock>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Текущий участник репозитория: "></TextBlock>
                            <TextBlock Text="{Binding RepositoryCollectionVM.CurrentRepositoryExplorerVM.SelectedRepositoryMember.Name}"></TextBlock>
                        </StackPanel>
                        <RibbonButton Label="Подробнее" Command="{Binding ApplicationCommandsVM.OpenRepositoryMemberDetailsWindow}" />
                    </RibbonGroup>
                    <RibbonGroup Header="Иерархия репозитория">
                        <RibbonButton Label="Добавить собственный корень" />
                        <RibbonButton Label="Добавить внешний корень" />
                        <RibbonButton Label="Добавить узел" />
                        <RibbonButton Label="Добавить лист" />
                        <RibbonButton Label="Удалить элемент" />
                    </RibbonGroup>
                    <RibbonGroup Header="Вхождения атрибутов">
                        <RibbonButton Label="Добавить вхождение" />
                        <RibbonButton Label="Удалить вхождение" />
                    </RibbonGroup>
                    <RibbonGroup Header="Атрибуты">
                        <RibbonButton Label="Добавить атрибут" />
                        <RibbonButton Label="Удалить атрибут" />
                    </RibbonGroup>
                    <RibbonGroup Header="Пресеты">
                        <RibbonButton Label="Добавить пресет" />
                        <RibbonButton Label="Удалить пресет" />
                    </RibbonGroup>
                </RibbonTab>
                <RibbonTab Header="Вставка">

                </RibbonTab>
                <RibbonTab Header="Рассылки">

                </RibbonTab>
                <RibbonTab Header="Вид">

                </RibbonTab>
                <RibbonTab Header="Расширения">

                </RibbonTab>
                <RibbonTab Header="Администрирование">

                </RibbonTab>
                <RibbonTab Header="Настройки">
                    <RibbonGroup Header="Хранилища">
                        <RibbonButton Label="Открыть настройки хранилищ" Command="{Binding OpenDataStorageSettings}"></RibbonButton>
                    </RibbonGroup>
                </RibbonTab>
                <RibbonTab Header="Справка">
                    <RibbonGroup>
                        <RibbonButton Label="О нас"></RibbonButton>
                    </RibbonGroup>

                </RibbonTab>
            </Ribbon>
            <Grid DockPanel.Dock="Top">
                <Grid.RowDefinitions>
                    <RowDefinition Height="4*"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="auto" MaxHeight="350"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="0"></RowDefinition>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0">
                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                        <RowDefinition Height="auto"></RowDefinition>
                        <RowDefinition Height="auto" MaxHeight="200"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="auto" MaxWidth="300"></ColumnDefinition>
                            <ColumnDefinition Width="auto"></ColumnDefinition>
                            <ColumnDefinition Width="5*"></ColumnDefinition>
                        </Grid.ColumnDefinitions>
                        <Expander Grid.Row="2" Grid.Column="0" ExpandDirection="Left" Margin="2">
                            <Expander.Header>
                                <TextBlock Text="Навигационная панель">
                                    <TextBlock.LayoutTransform>
                                        <RotateTransform Angle="-90"/>
                                    </TextBlock.LayoutTransform>
                                </TextBlock>
                            </Expander.Header>
                            <Grid Grid.Row="0" Grid.Column="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"></RowDefinition>
                                    <RowDefinition Height="auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>
                                <GroupBox Grid.Row="0" Grid.Column="0" Header="Сервисы" Margin="2" Background="White">
                                    <ListBox>
                                        <ListBoxItem Content="Дерево данных"></ListBoxItem>
                                        <ListBoxItem Content="Атрибуты"></ListBoxItem>
                                        <ListBoxItem Content="Отчеты"></ListBoxItem>
                                        <ListBoxItem Content="Настраиваемый отчет"></ListBoxItem>
                                        <ListBoxItem Content="Импорт / экспорт репозитория"></ListBoxItem>
                                        <ListBoxItem Content="Расширения, надстройки"></ListBoxItem>
                                        <ListBoxItem Content="Общие настройки"></ListBoxItem>
                                        <ListBoxItem Content="Настройки репозитория"></ListBoxItem>
                                        <ListBoxItem Content="Администрирование"></ListBoxItem>
                                    </ListBox>
                                </GroupBox>
                                <GridSplitter Grid.Row="1" Grid.Column="0" ShowsPreview="False" Height="3" HorizontalAlignment="Stretch" VerticalAlignment="Center"></GridSplitter>
                                <GroupBox Grid.Row="2" Grid.Column="0" Header="Надстройки" Margin="2" Background="White">
                                    <ListBox>
                                        <ListBoxItem Content="Git"></ListBoxItem>
                                        <ListBoxItem Content="Расчет трубопроводных элементов"></ListBoxItem>
                                        <ListBoxItem Content="Определение критической точки"></ListBoxItem>
                                        <ListBoxItem Content="Номинальные давления"></ListBoxItem>
                                        <ListBoxItem Content="Допускаемые напряжения"></ListBoxItem>
                                    </ListBox>
                                </GroupBox>
                            </Grid>
                        </Expander>
                        <GridSplitter Grid.Row="0" Grid.Column="1" ShowsPreview="False" Width="3" HorizontalAlignment="Center" VerticalAlignment="Stretch"></GridSplitter>
                        <GroupBox Grid.Row="0" Grid.Column="2" Header="Рабочая область" Margin="2" Background="White">
                            <TabControl Margin="2">
                                <TabItem Header="Репозиторий">
                                    <ctrls:RepositoryExplorer DataContext="{Binding RepositoryCollectionVM.CurrentRepositoryExplorerVM}"></ctrls:RepositoryExplorer>
                                </TabItem>
                                <TabItem Header="Отчеты">
                                    <ctrls:ReportProcessor></ctrls:ReportProcessor>
                                </TabItem>
                                <TabItem Header="Настраиваемый отчет">
                                    <ctrls:CustomizableReport></ctrls:CustomizableReport>
                                </TabItem>
                                <TabItem Header="Импорт / экспорт">
                                    <ctrls:DataExchange></ctrls:DataExchange>
                                </TabItem>
                            </TabControl>
                        </GroupBox>
                    </Grid>
                    <GridSplitter Grid.Row="1" Grid.Column="0" ShowsPreview="False" Height="3" HorizontalAlignment="Stretch" VerticalAlignment="Center"></GridSplitter>
                </Grid>
                <GridSplitter Grid.Row="1" Grid.Column="0" ShowsPreview="False" Height="3" HorizontalAlignment="Stretch" VerticalAlignment="Center"></GridSplitter>
                <Expander Grid.Row="2" Header="Сообщения" ExpandDirection="Down" Margin="2" IsExpanded="True">
                    <DataGrid ItemsSource="{Binding NotificationsVM.Notifications, Mode=OneWay}" AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Уровень критичности" Binding="{Binding CriticalLevel}" Width="35"></DataGridTextColumn>
                            <DataGridTextColumn Header="Время" Binding="{Binding DateTime,ConverterCulture=ru-RY}" Width="150"></DataGridTextColumn>
                            <DataGridTextColumn Header="Сообщение" Binding="{Binding Text}" Width="auto"></DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Expander>
                <Grid Grid.Row="3">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition></ColumnDefinition>
                        <ColumnDefinition Width="320"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <StackPanel x:Name="popupTarget" Grid.Column="1"></StackPanel>
                </Grid>
                <StatusBar Grid.Row="4">
                    <TextBlock Text="Приложение запущено"></TextBlock>
                </StatusBar>
                <ProgressBar Grid.Row="5" Minimum="0" Maximum="100" Value="{Binding CurrentProgress}" Height="3"></ProgressBar>
            </Grid>
        </DockPanel>
    </Grid>
</Window>
